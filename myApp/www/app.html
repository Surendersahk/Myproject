<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HELP_NET - Rescue Map</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_KEY"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: radial-gradient(circle at center, #141a1f 0%, #1f2937 70%);
      position: relative;
      overflow-x: hidden;
      color: #f0f0f0;
      min-height: 100vh;
    }

    /* Satellite grid */
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: 
        linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
      background-size: 40px 40px;
      z-index: -2;
    }

    /* Scanning line */
    body::after {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 2px;
      background: rgba(238, 6, 6, 0.5);
      animation: scan 4s linear infinite;
      z-index: -1;
    }

    @keyframes scan { 0% { top: 0; } 100% { top: 100%; } }

    /* Floating disaster icons */
    @keyframes float {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0.2; }
      100% { transform: translateY(-10vh) rotate(360deg); opacity: 0.05; }
    }
    .p1, .p2, .p3, .p4, .p5 {
      position: fixed; font-size: 28px; opacity: 0.1; z-index: -1; animation: float 15s infinite linear;
    }
    .p1 { left: 10%; animation-duration: 20s; }
    .p2 { left: 30%; animation-duration: 18s; }
    .p3 { left: 50%; animation-duration: 22s; }
    .p4 { left: 70%; animation-duration: 25s; }
    .p5 { left: 85%; animation-duration: 17s; }

    /* Form & map cards */
    .card { background: rgba(31, 41, 55, 0.85); padding: 1.5rem; border-radius: 1rem; box-shadow: 0 8px 16px rgba(0,0,0,0.3); }
    input, select, button, textarea { background: rgba(31,41,55,0.6); color: white; border: 1px solid #374151; border-radius: 0.5rem; padding: 0.5rem; width: 100%; }
    input::placeholder, textarea::placeholder { color: #a1a1aa; }
    button { background-color: #ef4444; transition: 0.3s; cursor: pointer; }
    button:hover { background-color: #dc2626; }
    #map { height: 500px; width: 100%; border-radius: 1rem; margin-top: 1rem; }
  </style>
</head>

<body class="flex flex-col items-center justify-start">

  <!-- Floating disaster icons -->
  <div class="p1">üî•</div>
  <div class="p2">üöë</div>
  <div class="p3">üåä</div>
  <div class="p4">üö®</div>
  <div class="p5">üè•</div>

  <!-- Header -->
  <header class="w-full py-6 text-center backdrop-blur-md shadow-md">
    <h1 class="text-3xl font-extrabold text-red-500 select-none">HELP_NET</h1>
    <p class="text-gray-200 mt-1 text-sm">Rescue Map & Emergency Requests</p>
  </header>

  <main class="max-w-6xl w-full px-6 py-12 flex flex-col md:flex-row gap-8">

    <!-- Rescue Request Form -->
    <section class="card flex-1 max-w-md mx-auto md:mx-0">
      <h2 class="text-xl font-extrabold text-red-500 mb-4 text-center">üìç Share My Location</h2>
      <form id="rescueForm" class="space-y-4">
        <input type="text" id="name" placeholder="Name" required />
        <input type="text" id="phone" placeholder="Phone" required />
        <select id="disasterType">
          <option value="Flood">Flood</option>
          <option value="Earthquake">Earthquake</option>
          <option value="Fire">Fire</option>
          <option value="Other">Other</option>
        </select>
        <button type="submit">Send Help Request</button>
      </form>
    </section>

    <!-- Map Section -->
    <section class="card flex-1 max-w-md mx-auto md:mx-0">
      <h2 class="text-xl font-extrabold text-red-500 mb-4 text-center">üåç Rescue Requests Map</h2>
      <div id="map"></div>
    </section>

  </main>

  <!-- Bottom Navigation -->
  <nav class="fixed bottom-0 left-0 right-0 bg-[#1f2937]/90 shadow-inner border-t flex justify-around items-center h-14 text-white">
    <a href="homepage.html" class="flex flex-col items-center hover:text-red-500"><i class="fas fa-home"></i><span class="text-xs">Home</span></a>
    <a href="news.html" class="flex flex-col items-center hover:text-red-500"><i class="fas fa-newspaper"></i><span class="text-xs">News</span></a>
    <a href="app.html" class="flex flex-col items-center hover:text-red-500"><i class="fas fa-map-marker-alt"></i><span class="text-xs">Request</span></a>
    <a href="contact.html" class="flex flex-col items-center hover:text-red-500"><i class="fas fa-phone-alt"></i><span class="text-xs">Contact</span></a>
  </nav>

  <script>
    const API_BASE = "http://localhost:5000/api";
    let map;

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 5,
        center: { lat: 20.5937, lng: 78.9629 }
      });
      loadRequests();
    }

    async function loadRequests() {
      try {
        const res = await axios.get(`${API_BASE}/rescue`);
        res.data.forEach(req => {
          new google.maps.Marker({
            position: { lat: req.latitude, lng: req.longitude },
            map: map,
            title: `${req.disasterType} - ${req.name} (${req.phone})`
          });
        });
      } catch (err) {
        console.error("Error loading requests:", err);
      }
    }

    document.getElementById("rescueForm").addEventListener("submit", async e => {
      e.preventDefault();
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(async pos => {
          const data = {
            name: document.getElementById("name").value,
            phone: document.getElementById("phone").value,
            disasterType: document.getElementById("disasterType").value,
            latitude: pos.coords.latitude,
            longitude: pos.coords.longitude
          };
          try {
            await axios.post(`${API_BASE}/rescue`, data);
            alert("üìç Rescue request sent!");
            loadRequests();
          } catch (err) {
            console.error("Error sending request:", err);
          }
        });
      } else {
        alert("Geolocation not supported.");
      }
    });

    window.onload = initMap;
  </script>

</body>
</html>
